<!DOCTYPE html>
<html ng-app="ionicApp">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
    <title></title>

    <link href="lib/ionic/css/ionic.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

    <!-- IF using Sass (run gulp sass first), then uncomment below and remove the CSS includes above
    <link href="css/ionic.app.css" rel="stylesheet">
    -->

    <!-- ionic/angularjs js -->
    <script src="lib/ionic/js/ionic.bundle.js"></script>

    <!-- cordova script (this will be a 404 during development) -->
    <script src="cordova.js"></script>

    <!-- your app's js -->
    <script src="js/app.js"></script>
    <script src="js/controllers.js"></script>
    <script src="js/services.js"></script>
    <script src="js/main.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>

  <body ng-controller="MainCtrl">
  <ion-side-menus>
  <ion-side-menu side="left">
            <div class="sizelogo">
           <ion-list>
            <img src="img/logo.png">
           </ion-list>
           </div>
           <div class="size">
           <button class="button-full button-clear" onClick="javascript:location.replace('menu.html')">
           <ion-list>
            <ion-item>
            <div class="c"><i class="ion-information-circled"> Information </i></div>
            </ion-item>
            </ion-list>
            </button>
          <button class="button button-full button-clear button-positive" onClick="javascript:location.replace('donation.html')">
           <ion-list>
            <ion-item>
            <div class="c"><i class="ion-waterdrop">  Donation</i></div>
            </ion-item>
          </ion-list>
          </button>
          <button class="button button-full button-clear button-positive" onClick="javascript:location.replace('requests.html')">
          <ion-list>
              <ion-item>
               <div class="c"><i class="ion-document-text"> Requests</i></div>
           </ion-item>
           </ion-list>
           </button>
           <button class="button button-full button-clear button-positive" onClick="javascript:location.replace('events.html')">
           <ion-list>
            <ion-item>
            <div class="c"><i class="ion-compose"> Create Events</i></div>
          </ion-item>
          </ion-list>
          </button>
          <button class="button button-full button-clear button-positive" onClick="javascript:location.replace('location.html')">
          <ion-list>
            <ion-item>
            <div class="c"><i class="ion-location"> Location</i></div>
            </ion-item>
          </ion-list>
          </button>
          <button class="button button-full button-clear button-positive" onClick="javascript:location.replace('list.html')">
          <ion-list>
            <ion-item>
            <div class="c"><i class="ion-clipboard"> List</i></div>
            </ion-item>
          </ion-list>
          </button>
          <button class="button button-full button-clear button-positive" onClick="javascript:location.replace('about.html')">
          <ion-list>
            <ion-item>
            <div class="c"><i class="ion-help-circled"> About</i></div>
            </ion-item>
          </ion-list>
          </button>
         </div>
      </ion-side-menu>
<body>
<ion-side-menu-content>
    <div class="bar bar-header bar-assertive">
    <button class="button button-icon icon ion-navicon" ng-click="toggleLeft()"></button>
    <div class="h1 title">Requests</div>
    <button class="button button-clear" onClick="javascript:location.replace('profile.html')"><i class="ion-person"></i></button>
    </button>
    </div>
      <ion-pane>
      <ion-content>

        <form method="post" action="#" enctype='application/json'>
        <div class="sizecardrequest">
        <div class="card" style="padding:10px;">
          <label class="item item-input item-select">
            <div class="input-label">Blood Type</div>
            <select name="bloodtype" id="bloodtype">
              <option value="A">A</option>
              <option value="B">B</option>
              <option value="AB">AB</option>
              <option value="O">O</option>
            </select>
          </label>
          <label class="item item-input item-select">
            <div class="input-label">Nearest PMI</div>
            <div id="id02"></div>
            <script>
            getMyJson("http://eritrosit.bajau.com:8100/eritrosit/api/instance");

            function myFunction(arr) {
                var out = "";
                var i;
                out += "<select name='instance_id' id='instance_id'>";
                for(i = 0; i < arr.length; i++) {
                  out += '<option value="'+arr[i].id+'">'+arr[i].name+'</option>';
                }
                out += "</select>";
                console.log(out);
                document.getElementById("id02").innerHTML = out;
            }
            </script>
          </label>
          <label class="item item-input item-select">
            <div class="input-label">Urgency</div>
            <select name="urgency" id="urgency">
              <option value="3">Normal</option>
              <option value="2">Urgent</option>
              <option value="1">Need Fast</option>
            </select>
          </label>
              <label class="item item-input"><div class="input-label">Receiver Name</div>
            <input type="text" placeholder="Receiver Name" name="receivername" id="receivername" required>
          </label>
          </label>
              <label class="item item-input"><div class="input-label">Age</div>
            <input type="text" placeholder="Age" name="age" id="age" required>
          </label>
          <label class="item item-input item-select">
            <div class="input-label">Sex</div>
            <select name="sex" id="sex">
              <option value="Male">Male</option>
              <option value="Female">Female</option>
            </select>
          </label>
          <label class="item item-input"><div class="input-label">Phone #</div>
            <input type="text" placeholder="Phone Number" name="phonenumber" id="phonenumber" required>
          </label>
          <label class="item item-input"><div class="input-label">Address</div>
            <textarea placeholder="Address" name="address" id="address" required></textarea>
          </label>
          <label class="item item-input"><div class="input-label">Remarks</div>
            <textarea placeholder="Add remarks for the conditions" name="remarks" id="remarks" required></textarea>
          </label>
          <input type="hidden" name="post" id="post" value="">
          <button class="button button-block">Sent Request</button>
        </div>
        </div>
    </form>
    </ion-content>
    </ion-pane>
    </ion-side-menu-content>
      <script>
        var date;
        date = new Date();
        date = date.getUTCFullYear() + '-' +
            ('00' + (date.getUTCMonth()+1)).slice(-2) + '-' +
            ('00' + date.getUTCDate()).slice(-2) + ' ' + 
            ('00' + date.getUTCHours()).slice(-2) + ':' + 
            ('00' + date.getUTCMinutes()).slice(-2) + ':' + 
            ('00' + date.getUTCSeconds()).slice(-2);
        //console.log(date);

        document.getElementById('post').value = date;

        var x1 = document.getElementById('receivername').value;
        var x2 = document.getElementById('age').value;
        var x3 = document.getElementById('sex').value;
        var x4 = document.getElementById('phonenumber').value;
        var x5 = document.getElementById('address').value;
        var x6 = document.getElementById('remarks').value;

        xx = x1+x2+x3+x4+x5+x6;
        console.log(xx);

        (function ($) {
            $.fn.serializeFormJSON = function () {

                var o = {};
                var a = this.serializeArray();
                $.each(a, function () {
                    if (o[this.name]) {
                        if (!o[this.name].push) {
                            o[this.name] = [o[this.name]];
                        }
                        o[this.name].push(this.value || '');
                    } else {
                        o[this.name] = this.value || '';
                    }
                });
                return o;
            };
        })(jQuery);

        $('form').submit(function (e) {
            e.preventDefault();
            var jsonData = $(this).serializeFormJSON();

            var jsonStr = jsonData;    
            console.log(jsonStr);

            var request = $.ajax({
              url: "http://eritrosit.bajau.com:8100/eritrosit/api/request",
              type: "POST",
              data: jsonData,
              dataType: "json"
            });

            alert('Blood Request sent. Thank You.');
            location.replace('menu.html');

        });
      </script>
      </body>
      </ion-side-menus>
      </body>
      </html>
